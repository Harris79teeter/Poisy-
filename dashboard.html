<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pöïsy Dashboard</title>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>

<!-- Paystack SDK -->
<script src="https://js.paystack.co/v1/inline.js"></script>

<style>
  body {
    font-family: 'Arial', sans-serif;
    margin: 0;
    padding: 0;
    background-color: #ff4d4d; /* Plain Red background */
    color: #fff;
    overflow-x: hidden;
  }

  nav {
    background-color: #28a745; /* Bright Green */
    padding: 15px 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  nav h2, nav a {
    color: #fff;
    font-weight: bold;
    text-decoration: none;
  }
  nav a:hover { text-decoration: underline; }

  section {
    position: absolute;
    top: 120px;
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    max-width: 400px;
    background: rgba(0,0,0,0.2);
    padding: 25px;
    border-radius: 15px;
    display: none;
    flex-direction: column;
    align-items: center;
    transition: all 0.5s ease;
  }
  section.active { display: flex; }

  .step-progress {
    position: absolute;
    top: 80px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 10px;
  }
  .step-progress div {
    width: 40px;
    height: 10px;
    background: rgba(255,255,255,0.4);
    border-radius: 5px;
  }
  .step-progress div.active { background: #28a745; }

  input {
    width: 90%;
    padding: 10px;
    margin: 10px 0;
    border-radius: 5px;
    border: none;
  }

  button {
    width: 95%;
    padding: 12px;
    margin: 10px 0;
    background-color: #FFD700; /* Gold buttons */
    color: #000;
    font-weight: bold;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 16px;
  }
  button:hover { background-color: #FFC300; }

  .back-btn {
    align-self: flex-start;
    cursor: pointer;
    font-size: 18px;
    margin-bottom: 10px;
    color: #fff;
  }

  .transaction-entry {
    background: rgba(0,0,0,0.2);
    padding: 10px;
    border-radius: 5px;
    width: 100%;
    text-align: left;
    margin-bottom: 10px;
  }

  footer {
    margin-top: 20px;
    padding: 20px;
    background-color: #28a745; /* Green footer */
    color: #fff;
    text-align: center;
  }
</style>
</head>
<body>

<nav>
  <h2>Pöïsy</h2>
  <a href="#" onclick="logout()">Logout</a>
</nav>

<div class="step-progress">
  <div id="prog1" class="active"></div>
  <div id="prog2"></div>
  <div id="prog3"></div>
  <div id="prog4"></div>
  <div id="prog5"></div>
  <div id="prog6"></div>
</div>

<!-- Step 1: Select recipient -->
<section id="step1" class="active">
  <h1>Send Money</h1>
  <p>Select recipient type</p>
  <button onclick="nextStep('momo')">Mobile Money</button>
  <button onclick="nextStep('bank')">Bank Account</button>
</section>

<!-- Step 2: Recipient details -->
<section id="step2">
  <span class="back-btn" onclick="prevStep('step1')">&larr; Back</span>
  <h2>Recipient Details</h2>
  <input type="text" id="recipientName" placeholder="Recipient Name" required><br>
  <div id="momoFields">
    <input type="text" id="recipientPhone" placeholder="Phone Number" required><br>
  </div>
  <div id="bankFields">
    <input type="text" id="bankName" placeholder="Bank Name"><br>
    <input type="text" id="accountNumber" placeholder="Account Number"><br>
  </div>
  <input type="number" id="amount" placeholder="Amount (GHS)" required><br>
  <button onclick="nextStep2()">Continue</button>
</section>

<!-- Step 3: Payment method -->
<section id="step3">
  <span class="back-btn" onclick="prevStep('step2')">&larr; Back</span>
  <h2>Choose Payment Method</h2>
  <button onclick="nextStep3('card')">Pay with Card</button>
  <button onclick="nextStep3('mobilemoneyghana')">Pay with Mobile Money (Ghana)</button>
  <button onclick="nextStep3('ussd')">Pay with USSD</button>
</section>

<!-- Step 4: Sending account number -->
<section id="step4">
  <span class="back-btn" onclick="prevStep('step3')">&larr; Back</span>
  <h2>Enter Sending Account Number</h2>
  <input type="text" id="senderAccount" placeholder="Your Account Number" required><br>
  <button onclick="nextStep4()">Continue</button>
</section>

<!-- Step 5: Sending account password -->
<section id="step5">
  <span class="back-btn" onclick="prevStep('step4')">&larr; Back</span>
  <h2>Enter Sending Account Password</h2>
  <input type="password" id="senderPassword" placeholder="Password" required><br>
  <button onclick="nextStep5()">Continue</button>
</section>

<!-- Step 6: Confirm password -->
<section id="step6">
  <span class="back-btn" onclick="prevStep('step5')">&larr; Back</span>
  <h2>Confirm Password</h2>
  <input type="password" id="confirmPassword" placeholder="Confirm Password" required><br>
  <button onclick="processPayment()">Send Money</button>
</section>

<!-- Transaction History at the End -->
<section id="transactionHistory">
  <h2>Transaction History</h2>
  <div id="historyList"></div>
  <button class="back-btn" onclick="goBackToStart()">&larr; Back to Start</button>
</section>

<footer>
  <p>Customer support: <a href="mailto:poisymhan@gmail.com">poisymhan@gmail.com</a></p>
</footer>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyB6vgNBWwaa5ScUqGutsDAV7Eu4YKMqfjg",
  authDomain: "poisy-2dedf.firebaseapp.com",
  projectId: "poisy-2dedf",
  storageBucket: "poisy-2dedf.appspot.com",
  messagingSenderId: "310724767012",
  appId: "1:310724767012:web:8a6f3e09510265b24917b1",
  measurementId: "G-KDB8PXKGWJ"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
auth.onAuthStateChanged(user => {
  if(!user){ alert("Login first"); window.location.href = "index.html";}
});
function logout(){ auth.signOut().then(()=>window.location.href="index.html"); }

let recipientType = '', paymentChannel = '';
let steps = ['step1','step2','step3','step4','step5','step6'];
let currentStep = 0;

function updateProgress(){
  steps.forEach((s,i)=>{
    document.getElementById('prog'+(i+1)).classList.remove('active');
  });
  document.getElementById('prog'+(currentStep+1)).classList.add('active');
}

function showStep(stepId){
  steps.forEach(s => document.getElementById(s).classList.remove('active'));
  document.getElementById(stepId).classList.add('active');
}

function nextStep(type){
  recipientType = type;
  document.getElementById('momoFields').style.display = (type==='momo')?'block':'none';
  document.getElementById('bankFields').style.display = (type==='bank')?'block':'none';
  currentStep=1; showStep('step2'); updateProgress();
}

function nextStep2(){
  const name=document.getElementById('recipientName').value;
  const phone=document.getElementById('recipientPhone').value;
  const bank=document.getElementById('bankName').value;
  const account=document.getElementById('accountNumber').value;
  const amount=document.getElementById('amount').value;
  if(!name||!amount||(recipientType==='momo'&&!phone)||(recipientType==='bank'&&(!bank||!account))){ alert("Fill all fields"); return;}
  currentStep=2; showStep('step3'); updateProgress();
}

function nextStep3(channel){ paymentChannel=channel; currentStep=3; showStep('step4'); updateProgress(); }
function nextStep4(){ if(!document.getElementById('senderAccount').value){ alert("Enter sending account"); return;} currentStep=4; showStep('step5'); updateProgress();}
function nextStep5(){ if(!document.getElementById('senderPassword').value){ alert("Enter password"); return;} currentStep=5; showStep('step6'); updateProgress(); }

function prevStep(stepId){
  currentStep = steps.indexOf(stepId);
  showStep(stepId);
  updateProgress();
}

function processPayment(){
  const password=document.getElementById('senderPassword').value;
  const confirm=document.getElementById('confirmPassword').value;
  if(password!==confirm){ alert("Passwords do not match"); return; }
  alert("Payment would proceed to Paystack here!");
  const tx={name:document.getElementById('recipientName').value,
            phone:document.getElementById('recipientPhone').value||'',
            bank:document.getElementById('bankName').value||'',
            account:document.getElementById('accountNumber').value||'',
            amount:document.getElementById('amount').value,
            ref:"TX_"+Math.floor(Math.random()*1000000)};
  saveTransaction(tx);
  resetForm();
  // Show transaction history
  showTransactionHistory();
}

function saveTransaction(tx){
  let history=JSON.parse(localStorage.getItem('transactions'))||[];
  history.unshift(tx);
  localStorage.setItem('transactions',JSON.stringify(history));
}

function displayHistory(){
  const historyList=document.getElementById('historyList');
  let history=JSON.parse(localStorage.getItem('transactions'))||[];
  historyList.innerHTML='';
  history.forEach(tx=>{
    const div=document.createElement('div');
    div.className='transaction-entry';
    div.innerHTML=`<strong>Recipient:</strong> ${tx.name} ${tx.phone||''} ${tx.bank||''} ${tx.account||''}<br>
                   <strong>Amount:</strong> GHS ${tx.amount}<br>
                   <strong>Reference:</strong> ${tx.ref}`;
    historyList.appendChild(div);
  });
}

function resetForm(){
  ['recipientName','recipientPhone','bankName','accountNumber','amount','senderAccount','senderPassword','confirmPassword'].forEach(id=>document.getElementById(id).value='');
  currentStep=0; showStep('step1'); updateProgress();
}

function showTransactionHistory(){
  displayHistory();
  // Hide all steps
  steps.forEach(s => document.getElementById(s).classList.remove('active'));
  document.getElementById('transactionHistory').style.display='flex';
}

function goBackToStart(){
  document.getElementById('transactionHistory').style.display='none';
  currentStep = 0; showStep('step1'); updateProgress();
}

window.onload=displayHistory;
</script>
</body>
  </html>
